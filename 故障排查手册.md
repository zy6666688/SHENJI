# æ•…éšœæ’æŸ¥æ‰‹å†Œ

**å®¡è®¡æ•°æ™ºæ V2.0 - Troubleshooting Guide**

ğŸ” **å¿«é€Ÿè¯Šæ–­** | ğŸ› ï¸ **å®ç”¨æ–¹æ¡ˆ** | âœ… **é—®é¢˜è§£å†³**

---

## ğŸ“‹ ç›®å½•

1. [å¿«é€Ÿè¯Šæ–­æµç¨‹](#å¿«é€Ÿè¯Šæ–­æµç¨‹)
2. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
3. [ç³»ç»Ÿæ•…éšœ](#ç³»ç»Ÿæ•…éšœ)
4. [æ€§èƒ½é—®é¢˜](#æ€§èƒ½é—®é¢˜)
5. [æ•°æ®é—®é¢˜](#æ•°æ®é—®é¢˜)
6. [ç½‘ç»œé—®é¢˜](#ç½‘ç»œé—®é¢˜)
7. [è¯Šæ–­å·¥å…·](#è¯Šæ–­å·¥å…·)

---

## ğŸš€ å¿«é€Ÿè¯Šæ–­æµç¨‹

### 5åˆ†é’Ÿå¿«é€Ÿæ£€æŸ¥

```bash
# 1. æ£€æŸ¥åº”ç”¨æ˜¯å¦è¿è¡Œ
pm2 status

# 2. æ£€æŸ¥å¥åº·çŠ¶æ€
curl http://localhost:3000/api/system/health

# 3. æŸ¥çœ‹æœ€è¿‘é”™è¯¯
tail -50 logs/error-$(date +%Y-%m-%d).log

# 4. æ£€æŸ¥èµ„æºä½¿ç”¨
pm2 monit

# 5. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
journalctl -u audit-backend -n 50
```

### é—®é¢˜åˆ†ç±»å†³ç­–æ ‘

```
é—®é¢˜ç±»å‹ï¼Ÿ
â”œâ”€ å®Œå…¨ä¸å¯è®¿é—® â†’ [ç³»ç»Ÿæ•…éšœ](#ç³»ç»Ÿæ•…éšœ)
â”œâ”€ å“åº”ç¼“æ…¢ â†’ [æ€§èƒ½é—®é¢˜](#æ€§èƒ½é—®é¢˜)
â”œâ”€ æ•°æ®å¼‚å¸¸ â†’ [æ•°æ®é—®é¢˜](#æ•°æ®é—®é¢˜)
â”œâ”€ åŠŸèƒ½é”™è¯¯ â†’ [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
â””â”€ è¿æ¥å¤±è´¥ â†’ [ç½‘ç»œé—®é¢˜](#ç½‘ç»œé—®é¢˜)
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: æ— æ³•å¯åŠ¨åº”ç”¨

**ç—‡çŠ¶**:
```bash
npm run start:v2
# Error: Cannot find module...
```

**è¯Šæ–­**:
```bash
# 1. æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…
ls node_modules/ | wc -l

# 2. æ£€æŸ¥æ„å»ºäº§ç‰©
ls dist/

# 3. æ£€æŸ¥Nodeç‰ˆæœ¬
node --version
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆA: é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules package-lock.json
npm install

# æ–¹æ¡ˆB: é‡æ–°æ„å»º
npm run build

# æ–¹æ¡ˆC: æ£€æŸ¥Nodeç‰ˆæœ¬
nvm use 18  # æˆ–ä½¿ç”¨æ­£ç¡®ç‰ˆæœ¬
```

---

### Q2: ç«¯å£è¢«å ç”¨

**ç—‡çŠ¶**:
```
Error: listen EADDRINUSE: address already in use :::3000
```

**è¯Šæ–­**:
```bash
# Linux/Mac
lsof -i :3000

# Windows
netstat -ano | findstr :3000
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆA: åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹
kill -9 <PID>

# æ–¹æ¡ˆB: ä¿®æ”¹ç«¯å£
# åœ¨ .env æ–‡ä»¶ä¸­: PORT=3001

# æ–¹æ¡ˆC: åœæ­¢PM2è¿›ç¨‹
pm2 stop all
pm2 delete all
```

---

### Q3: æ•°æ®åº“è¿æ¥å¤±è´¥

**ç—‡çŠ¶**:
```
PrismaClientInitializationError: Can't reach database server
```

**è¯Šæ–­**:
```bash
# 1. æ£€æŸ¥PostgreSQLçŠ¶æ€
sudo systemctl status postgresql

# 2. æµ‹è¯•æ•°æ®åº“è¿æ¥
psql -U postgres -d audit_db -c "SELECT 1;"

# 3. æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²
echo $DATABASE_URL
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆA: å¯åŠ¨PostgreSQL
sudo systemctl start postgresql

# æ–¹æ¡ˆB: æ£€æŸ¥é˜²ç«å¢™
sudo ufw allow 5432/tcp

# æ–¹æ¡ˆC: é‡ç½®è¿æ¥
npm run prisma:migrate reset
npm run prisma:generate

# æ–¹æ¡ˆD: ä¿®æ”¹è¿æ¥å­—ç¬¦ä¸²
# .env æ–‡ä»¶ä¸­ç¡®è®¤:
DATABASE_URL="postgresql://user:pass@localhost:5432/audit_db"
```

---

### Q4: JWTéªŒè¯å¤±è´¥

**ç—‡çŠ¶**:
```json
{
  "success": false,
  "error": "Invalid token"
}
```

**è¯Šæ–­**:
```bash
# 1. æ£€æŸ¥tokenæ ¼å¼
echo $TOKEN | cut -d'.' -f1 | base64 -d

# 2. æ£€æŸ¥JWT_SECRET
grep JWT_SECRET .env

# 3. éªŒè¯tokenæœªè¿‡æœŸ
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆA: é‡æ–°ç™»å½•è·å–æ–°token
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"user@example.com","password":"pass"}'

# æ–¹æ¡ˆB: æ£€æŸ¥JWT_SECRETä¸€è‡´æ€§
# ç¡®ä¿ .env ä¸­çš„ JWT_SECRET æ²¡æœ‰æ”¹å˜

# æ–¹æ¡ˆC: æ¸…é™¤æ—§token
# å‰ç«¯: localStorage.removeItem('token')
```

---

### Q5: CORSé”™è¯¯

**ç—‡çŠ¶**:
```
Access to ... has been blocked by CORS policy
```

**è¯Šæ–­**:
```bash
# æ£€æŸ¥CORSé…ç½®
grep CORS_ORIGIN .env

# æŸ¥çœ‹è¯·æ±‚æ¥æº
curl -I -H "Origin: http://example.com" \
  http://localhost:3000/api/system/health
```

**è§£å†³æ–¹æ¡ˆ**:
```env
# .env æ–‡ä»¶ä¸­æ·»åŠ å…è®¸çš„æº
CORS_ORIGIN=http://localhost:5173,https://yourdomain.com

# å¤šä¸ªæºç”¨é€—å·åˆ†éš”
```

é‡å¯åº”ç”¨:
```bash
pm2 restart audit-backend
```

---

### Q6: å†…å­˜æ³„æ¼

**ç—‡çŠ¶**:
- å†…å­˜ä½¿ç”¨æŒç»­å¢é•¿
- åº”ç”¨å˜æ…¢æˆ–å´©æºƒ
- PM2è‡ªåŠ¨é‡å¯

**è¯Šæ–­**:
```bash
# 1. æŸ¥çœ‹å†…å­˜ä½¿ç”¨
pm2 monit

# 2. è·å–å†…å­˜å¿«ç…§
curl http://localhost:3000/api/system/status | \
  jq '.data.performance.memory'

# 3. æ£€æŸ¥é‡å¯å†å²
pm2 logs --lines 100 | grep "restart"
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä¸´æ—¶æ–¹æ¡ˆ: é‡å¯åº”ç”¨
pm2 restart audit-backend

# é•¿æœŸæ–¹æ¡ˆ: è®¾ç½®å†…å­˜é™åˆ¶
pm2 start ecosystem.config.js --max-memory-restart 1G

# åˆ†æå†…å­˜ä½¿ç”¨
node --inspect dist/index.v2.js
# ç„¶åä½¿ç”¨ Chrome DevTools åˆ†æ
```

---

### Q7: æ–‡ä»¶ä¸Šä¼ å¤±è´¥

**ç—‡çŠ¶**:
```
Error: File too large
```

**è¯Šæ–­**:
```bash
# æ£€æŸ¥æ–‡ä»¶å¤§å°é™åˆ¶
grep MAX_FILE_SIZE .env
```

**è§£å†³æ–¹æ¡ˆ**:
```env
# .env ä¸­è°ƒæ•´é™åˆ¶
MAX_FILE_SIZE=10485760  # 10MB
```

æˆ–ä¿®æ”¹ä»£ç :
```typescript
app.use(express.json({ limit: '10mb' }));
app.use(express.urlencoded({ limit: '10mb', extended: true }));
```

---

### Q8: Prismaè¿ç§»å¤±è´¥

**ç—‡çŠ¶**:
```
Migration failed with error: ...
```

**è¯Šæ–­**:
```bash
# 1. æŸ¥çœ‹è¿ç§»çŠ¶æ€
npx prisma migrate status

# 2. æ£€æŸ¥æ•°æ®åº“é”
# PostgreSQL
SELECT * FROM pg_locks WHERE NOT granted;
```

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆA: é‡è¯•è¿ç§»
npx prisma migrate deploy

# æ–¹æ¡ˆB: æ ‡è®°è¿ç§»ä¸ºå·²åº”ç”¨
npx prisma migrate resolve --applied <migration_name>

# æ–¹æ¡ˆC: é‡ç½®æ•°æ®åº“ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
npx prisma migrate reset

# æ–¹æ¡ˆD: æ‰‹åŠ¨ä¿®å¤
psql -U postgres -d audit_db
# æ‰‹åŠ¨æ‰§è¡ŒSQLä¿®å¤
```

---

## ğŸ”¥ ç³»ç»Ÿæ•…éšœ

### S1: åº”ç”¨å®Œå…¨å´©æºƒ

**ç´§æ€¥å“åº”æ­¥éª¤**:

```bash
# Step 1: æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
pm2 status
ps aux | grep node

# Step 2: æŸ¥çœ‹å´©æºƒæ—¥å¿—
pm2 logs audit-backend --err --lines 100

# Step 3: æ£€æŸ¥ç³»ç»Ÿèµ„æº
free -h
df -h

# Step 4: å°è¯•é‡å¯
pm2 restart audit-backend

# Step 5: å¦‚æœå¤±è´¥ï¼Œå›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
git checkout <previous-tag>
npm run build
pm2 restart audit-backend
```

**æ ¹å› åˆ†æ**:
```bash
# åˆ†æé”™è¯¯æ—¥å¿—
grep "Error" logs/error-*.log | tail -100

# æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—
journalctl -xe

# æ•°æ®åº“æ—¥å¿—
tail -100 /var/log/postgresql/postgresql-14-main.log
```

---

### S2: æ•°æ®åº“æ­»é”

**ç—‡çŠ¶**:
- éƒ¨åˆ†è¯·æ±‚è¶…æ—¶
- æ—¥å¿—æ˜¾ç¤ºæ­»é”é”™è¯¯

**è¯Šæ–­**:
```sql
-- æŸ¥çœ‹å½“å‰é”
SELECT * FROM pg_locks WHERE NOT granted;

-- æŸ¥çœ‹é˜»å¡æŸ¥è¯¢
SELECT 
  pid,
  usename,
  pg_blocking_pids(pid) as blocked_by,
  query as blocked_query
FROM pg_stat_activity
WHERE cardinality(pg_blocking_pids(pid)) > 0;
```

**è§£å†³**:
```sql
-- ç»ˆæ­¢é˜»å¡çš„æŸ¥è¯¢
SELECT pg_terminate_backend(pid);

-- æˆ–é‡å¯PostgreSQL
sudo systemctl restart postgresql
```

---

### S3: ç£ç›˜ç©ºé—´ä¸è¶³

**ç—‡çŠ¶**:
```
ENOSPC: no space left on device
```

**è¯Šæ–­**:
```bash
# æ£€æŸ¥ç£ç›˜ä½¿ç”¨
df -h

# æŸ¥æ‰¾å¤§æ–‡ä»¶
du -sh /* | sort -rh | head -10

# æŸ¥æ‰¾æ—¥å¿—æ–‡ä»¶
find /var/log -type f -size +100M
```

**è§£å†³**:
```bash
# æ¸…ç†æ—§æ—¥å¿—
find logs/ -name "*.log" -mtime +30 -delete

# æ¸…ç†PM2æ—¥å¿—
pm2 flush

# æ¸…ç†ç³»ç»Ÿæ—¥å¿—
sudo journalctl --vacuum-time=7d

# æ¸…ç†npmç¼“å­˜
npm cache clean --force

# æ¸…ç†Dockerï¼ˆå¦‚ä½¿ç”¨ï¼‰
docker system prune -a
```

---

## âš¡ æ€§èƒ½é—®é¢˜

### P1: APIå“åº”ç¼“æ…¢

**ç—‡çŠ¶**:
- è¯·æ±‚è€—æ—¶ > 1ç§’
- ç”¨æˆ·åé¦ˆå¡é¡¿

**è¯Šæ–­**:
```bash
# 1. æµ‹è¯•APIå“åº”æ—¶é—´
time curl http://localhost:3000/api/workflows

# 2. æŸ¥çœ‹æ…¢æŸ¥è¯¢
grep "Slow Query" logs/combined-*.log

# 3. æ£€æŸ¥æ•°æ®åº“æ€§èƒ½
# PostgreSQL
SELECT query, mean_exec_time, calls 
FROM pg_stat_statements 
ORDER BY mean_exec_time DESC 
LIMIT 10;
```

**è§£å†³**:
```bash
# æ–¹æ¡ˆA: æ·»åŠ æ•°æ®åº“ç´¢å¼•
# åœ¨Prisma schemaä¸­æ·»åŠ  @@index

# æ–¹æ¡ˆB: å¯ç”¨æŸ¥è¯¢ç¼“å­˜
# å®ç°Redisç¼“å­˜

# æ–¹æ¡ˆC: ä¼˜åŒ–æŸ¥è¯¢
# å‡å°‘JOINï¼Œä½¿ç”¨selectå­—æ®µ

# æ–¹æ¡ˆD: å¢åŠ èµ„æº
# å‡çº§æœåŠ¡å™¨é…ç½®
```

---

### P2: å†…å­˜ä½¿ç”¨è¿‡é«˜

**ç—‡çŠ¶**:
- å†…å­˜ä½¿ç”¨ > 80%
- PM2æ˜¾ç¤ºå†…å­˜å‘Šè­¦

**è¯Šæ–­**:
```bash
# 1. æŸ¥çœ‹è¿›ç¨‹å†…å­˜
ps aux --sort=-%mem | head

# 2. Node.jså †å¿«ç…§
node --inspect dist/index.v2.js
# Chrome DevTools > Memory > Take Heap Snapshot

# 3. æ£€æŸ¥å†…å­˜æ³„æ¼
pm2 logs | grep "heap"
```

**è§£å†³**:
```bash
# æ–¹æ¡ˆA: é‡å¯é‡Šæ”¾å†…å­˜
pm2 restart audit-backend

# æ–¹æ¡ˆB: å¢åŠ å †å†…å­˜é™åˆ¶
NODE_OPTIONS="--max-old-space-size=2048" pm2 start

# æ–¹æ¡ˆC: ä»£ç ä¼˜åŒ–
# - æ¸…ç†æœªä½¿ç”¨çš„å˜é‡
# - é¿å…å…¨å±€å˜é‡
# - åŠæ—¶å…³é—­è¿æ¥

# æ–¹æ¡ˆD: ä½¿ç”¨é›†ç¾¤æ¨¡å¼
pm2 start ecosystem.config.js -i 4
```

---

### P3: CPUä½¿ç”¨ç‡é«˜

**ç—‡çŠ¶**:
- CPU > 90%
- ç³»ç»Ÿå“åº”ç¼“æ…¢

**è¯Šæ–­**:
```bash
# 1. æŸ¥çœ‹CPUä½¿ç”¨
top -o %CPU

# 2. Node.js CPU profile
node --prof dist/index.v2.js
node --prof-process isolate-*.log > processed.txt

# 3. æ£€æŸ¥è€—CPUçš„æŸ¥è¯¢
```

**è§£å†³**:
```bash
# æ–¹æ¡ˆA: ä¼˜åŒ–ç®—æ³•
# å‡å°‘å¾ªç¯åµŒå¥—
# ä½¿ç”¨å¼‚æ­¥å¤„ç†

# æ–¹æ¡ˆB: å¯ç”¨é›†ç¾¤
pm2 start -i max

# æ–¹æ¡ˆC: ç¼“å­˜è®¡ç®—ç»“æœ
# ä½¿ç”¨Redisç¼“å­˜

# æ–¹æ¡ˆD: é™æµ
# æ·»åŠ rate limiting
```

---

## ğŸ’¾ æ•°æ®é—®é¢˜

### D1: æ•°æ®ä¸ä¸€è‡´

**ç—‡çŠ¶**:
- å·¥ä½œæµçŠ¶æ€å¼‚å¸¸
- æ‰§è¡Œè®°å½•ä¸¢å¤±

**è¯Šæ–­**:
```sql
-- æ£€æŸ¥æ•°æ®å®Œæ•´æ€§
SELECT COUNT(*) FROM workflows WHERE status IS NULL;

-- æŸ¥æ‰¾å­¤ç«‹è®°å½•
SELECT * FROM executions 
WHERE workflow_id NOT IN (SELECT id FROM workflows);
```

**è§£å†³**:
```sql
-- æ–¹æ¡ˆA: æ•°æ®ä¿®å¤
UPDATE workflows SET status = 'active' WHERE status IS NULL;

-- æ–¹æ¡ˆB: æ¸…ç†å­¤ç«‹æ•°æ®
DELETE FROM executions 
WHERE workflow_id NOT IN (SELECT id FROM workflows);

-- æ–¹æ¡ˆC: ä»å¤‡ä»½æ¢å¤
psql -U postgres audit_db < backup.sql
```

---

### D2: å¤‡ä»½æ¢å¤

**æ¢å¤æ­¥éª¤**:
```bash
# Step 1: åœæ­¢åº”ç”¨
pm2 stop audit-backend

# Step 2: å¤‡ä»½å½“å‰æ•°æ®åº“
pg_dump -U postgres audit_db > current_backup.sql

# Step 3: åˆ é™¤å½“å‰æ•°æ®åº“
dropdb -U postgres audit_db

# Step 4: åˆ›å»ºæ–°æ•°æ®åº“
createdb -U postgres audit_db

# Step 5: æ¢å¤å¤‡ä»½
psql -U postgres audit_db < backup_YYYYMMDD.sql

# Step 6: éªŒè¯æ•°æ®
psql -U postgres audit_db -c "SELECT COUNT(*) FROM workflows;"

# Step 7: é‡å¯åº”ç”¨
pm2 start audit-backend
```

---

## ğŸŒ ç½‘ç»œé—®é¢˜

### N1: æ— æ³•è®¿é—®API

**è¯Šæ–­**:
```bash
# 1. æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tlnp | grep 3000

# 2. æµ‹è¯•æœ¬åœ°è®¿é—®
curl http://localhost:3000/api/system/health

# 3. æ£€æŸ¥é˜²ç«å¢™
sudo ufw status

# 4. æ£€æŸ¥Nginxï¼ˆå¦‚ä½¿ç”¨ï¼‰
sudo nginx -t
sudo systemctl status nginx
```

**è§£å†³**:
```bash
# æ–¹æ¡ˆA: å¼€æ”¾ç«¯å£
sudo ufw allow 3000/tcp

# æ–¹æ¡ˆB: æ£€æŸ¥Nginxé…ç½®
sudo nano /etc/nginx/sites-available/default
sudo nginx -s reload

# æ–¹æ¡ˆC: æ£€æŸ¥ç»‘å®šåœ°å€
# .env ä¸­: HOST=0.0.0.0
```

---

### N2: SSLè¯ä¹¦é—®é¢˜

**ç—‡çŠ¶**:
```
NET::ERR_CERT_AUTHORITY_INVALID
```

**è¯Šæ–­**:
```bash
# æ£€æŸ¥è¯ä¹¦
openssl x509 -in cert.pem -text -noout

# æµ‹è¯•SSL
curl -vI https://yourdomain.com
```

**è§£å†³**:
```bash
# æ–¹æ¡ˆA: æ›´æ–°è¯ä¹¦
sudo certbot renew

# æ–¹æ¡ˆB: é‡æ–°å®‰è£…
sudo certbot --nginx -d yourdomain.com

# æ–¹æ¡ˆC: ä½¿ç”¨Let's Encrypt
sudo certbot certonly --standalone -d yourdomain.com
```

---

## ğŸ› ï¸ è¯Šæ–­å·¥å…·

### ç³»ç»Ÿä¿¡æ¯æ”¶é›†è„šæœ¬

åˆ›å»º `diagnostic.sh`:

```bash
#!/bin/bash

echo "=== Audit System Diagnostic Report ==="
echo "Generated: $(date)"
echo ""

echo "=== System Info ==="
uname -a
echo "CPU Cores: $(nproc)"
echo "Memory: $(free -h | grep Mem | awk '{print $2}')"
echo "Disk: $(df -h / | tail -1 | awk '{print $4}' available)"
echo ""

echo "=== Node.js Version ==="
node --version
npm --version
echo ""

echo "=== Application Status ==="
pm2 status
echo ""

echo "=== Health Check ==="
curl -s http://localhost:3000/api/system/health | jq '.'
echo ""

echo "=== Recent Errors ==="
tail -20 logs/error-$(date +%Y-%m-%d).log
echo ""

echo "=== Database Status ==="
psql -U postgres -c "SELECT version();"
psql -U postgres -d audit_db -c "SELECT COUNT(*) FROM workflows;"
echo ""

echo "=== Resource Usage ==="
echo "CPU:"
top -bn1 | grep "Cpu(s)" | sed "s/.*, *\([0-9.]*\)%* id.*/\1/" | awk '{print 100 - $1"%"}'
echo "Memory:"
free | grep Mem | awk '{printf("%.2f%%\n", $3/$2 * 100.0)}'
echo ""

echo "=== Network ==="
netstat -tlnp | grep :3000
echo ""

echo "=== End of Report ==="
```

ä½¿ç”¨:
```bash
chmod +x diagnostic.sh
./diagnostic.sh > diagnostic_report.txt
```

---

### æ€§èƒ½åˆ†æå·¥å…·

**1. Node.js Clinic**:
```bash
npm install -g clinic

# CPUåˆ†æ
clinic doctor -- node dist/index.v2.js

# å†…å­˜åˆ†æ
clinic heapprofiler -- node dist/index.v2.js

# ç«ç„°å›¾
clinic flame -- node dist/index.v2.js
```

**2. Apache Bench**:
```bash
# å‹åŠ›æµ‹è¯•
ab -n 1000 -c 100 http://localhost:3000/api/workflows
```

**3. PostgreSQLåˆ†æ**:
```sql
-- å¯ç”¨ç»Ÿè®¡
CREATE EXTENSION IF NOT EXISTS pg_stat_statements;

-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SELECT query, mean_exec_time, calls
FROM pg_stat_statements
ORDER BY mean_exec_time DESC
LIMIT 20;

-- æŸ¥çœ‹è¡¨å¤§å°
SELECT 
  schemaname,
  tablename,
  pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_tables
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;
```

---

## ğŸ“ è·å–å¸®åŠ©

### å†…éƒ¨æ”¯æŒæµç¨‹

1. **æŸ¥é˜…æ–‡æ¡£** - æœ¬æ‰‹å†Œå’Œå…¶ä»–æ–‡æ¡£
2. **æœç´¢Issue** - GitHub Issueså†å²
3. **æ”¶é›†ä¿¡æ¯** - è¿è¡Œdiagnostic.sh
4. **æäº¤å·¥å•** - åŒ…å«å®Œæ•´è¯Šæ–­æŠ¥å‘Š
5. **ç´§æ€¥æƒ…å†µ** - æ‹¨æ‰“24å°æ—¶çƒ­çº¿

### æäº¤BugæŠ¥å‘Šæ¨¡æ¿

```markdown
### é—®é¢˜æè¿°
ç®€è¦æè¿°é—®é¢˜

### å¤ç°æ­¥éª¤
1. æ­¥éª¤1
2. æ­¥éª¤2
3. ...

### é¢„æœŸè¡Œä¸º
åº”è¯¥å‘ç”Ÿä»€ä¹ˆ

### å®é™…è¡Œä¸º
å®é™…å‘ç”Ÿäº†ä»€ä¹ˆ

### ç¯å¢ƒä¿¡æ¯
- Node.jsç‰ˆæœ¬:
- æ“ä½œç³»ç»Ÿ:
- æ•°æ®åº“ç‰ˆæœ¬:

### æ—¥å¿—
```
ç²˜è´´ç›¸å…³æ—¥å¿—
```

### è¯Šæ–­æŠ¥å‘Š
é™„ä¸Š diagnostic_report.txt
```

---

## âœ… é¢„é˜²æ€§ç»´æŠ¤

### æ¯æ—¥ä»»åŠ¡
- [ ] æŸ¥çœ‹é”™è¯¯æ—¥å¿—
- [ ] æ£€æŸ¥ç³»ç»Ÿèµ„æº
- [ ] å¤‡ä»½æ•°æ®åº“
- [ ] ç›‘æ§å‘Šè­¦

### æ¯å‘¨ä»»åŠ¡
- [ ] åˆ†ææ€§èƒ½è¶‹åŠ¿
- [ ] æ¸…ç†æ—§æ—¥å¿—
- [ ] æ›´æ–°ä¾èµ–åŒ…
- [ ] å®‰å…¨æ‰«æ

### æ¯æœˆä»»åŠ¡
- [ ] å…¨é¢æ€§èƒ½è¯„ä¼°
- [ ] å¤‡ä»½éªŒè¯
- [ ] å®¹é‡è§„åˆ’
- [ ] æ–‡æ¡£æ›´æ–°

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025å¹´1æœˆ4æ—¥  
**ç»´æŠ¤å›¢é˜Ÿ**: SHENJI Team

**é‡åˆ°é—®é¢˜ä¸è¦æ…Œï¼ŒæŒ‰æ­¥éª¤æ’æŸ¥ï¼** ğŸ’ª
