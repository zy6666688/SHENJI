# å¿«é€Ÿå¯åŠ¨æŒ‡å—

**å®¡è®¡æ•°æ™ºæ V2.0 - Quick Start Guide**

ğŸš€ **5åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹** | ğŸ“– **æ–°æ‰‹å‹å¥½** | âš¡ **å³åˆ»å¼€å§‹**

---

## ğŸ“‹ ç›®å½•

1. [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
2. [å¿«é€Ÿå®‰è£…](#å¿«é€Ÿå®‰è£…)
3. [åŸºç¡€é…ç½®](#åŸºç¡€é…ç½®)
4. [å¯åŠ¨åº”ç”¨](#å¯åŠ¨åº”ç”¨)
5. [é¦–æ¬¡ä½¿ç”¨](#é¦–æ¬¡ä½¿ç”¨)
6. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸ’» ç¯å¢ƒè¦æ±‚

### æœ€ä½é…ç½®

| é¡¹ç›® | è¦æ±‚ |
|------|------|
| **æ“ä½œç³»ç»Ÿ** | Windows 10+, macOS 10.15+, Linux (Ubuntu 20.04+) |
| **Node.js** | v18.x æˆ–æ›´é«˜ç‰ˆæœ¬ |
| **å†…å­˜** | 4GB |
| **ç£ç›˜ç©ºé—´** | 10GB |

### æ¨èé…ç½®

| é¡¹ç›® | è¦æ±‚ |
|------|------|
| **CPU** | 4æ ¸æˆ–æ›´å¤š |
| **å†…å­˜** | 8GBæˆ–æ›´å¤š |
| **Node.js** | v20.x (LTS) |
| **PostgreSQL** | v14+ |

### æ£€æŸ¥ç¯å¢ƒ

```bash
# æ£€æŸ¥Node.jsç‰ˆæœ¬
node --version
# åº”è¾“å‡º: v18.x.x æˆ–æ›´é«˜

# æ£€æŸ¥npmç‰ˆæœ¬
npm --version
# åº”è¾“å‡º: v9.x.x æˆ–æ›´é«˜
```

---

## ğŸ“¥ å¿«é€Ÿå®‰è£…

### æ–¹å¼ä¸€ï¼šGitå…‹éš†ï¼ˆæ¨èï¼‰

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/zy6666688/SHENJI.git
cd SHENJI

# 2. å®‰è£…ä¾èµ–
cd packages/backend
npm install

# 3. å®Œæˆï¼
```

### æ–¹å¼äºŒï¼šä¸‹è½½ZIP

```bash
# 1. ä»GitHubä¸‹è½½ZIPæ–‡ä»¶å¹¶è§£å‹

# 2. è¿›å…¥é¡¹ç›®ç›®å½•
cd SHENJI/packages/backend

# 3. å®‰è£…ä¾èµ–
npm install
```

### éªŒè¯å®‰è£…

```bash
# æŸ¥çœ‹å·²å®‰è£…çš„åŒ…
npm list --depth=0

# åº”è¯¥çœ‹åˆ°æ‰€æœ‰ä¾èµ–åŒ…åˆ—è¡¨
```

---

## âš™ï¸ åŸºç¡€é…ç½®

### 1. åˆ›å»ºé…ç½®æ–‡ä»¶

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env
```

### 2. åŸºç¡€é…ç½®ï¼ˆå¿…éœ€ï¼‰

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
# ===== åŸºç¡€é…ç½® =====
NODE_ENV=development
PORT=3000

# ===== æ•°æ®åº“é…ç½® =====
# å¼€å‘ç¯å¢ƒå¯ä½¿ç”¨SQLiteï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
DATABASE_URL="file:./dev.db"

# æˆ–ä½¿ç”¨PostgreSQLï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰
# DATABASE_URL="postgresql://user:password@localhost:5432/audit_db"

# ===== JWTå¯†é’¥ =====
# éšæœºç”Ÿæˆä¸€ä¸ªå¼ºå¯†é’¥
JWT_SECRET="your-super-secret-jwt-key-change-this"

# ===== CORSé…ç½® =====
CORS_ORIGIN=http://localhost:5173
```

### 3. åŠŸèƒ½é…ç½®ï¼ˆå¯é€‰ï¼‰

```env
# ===== æ’ä»¶ç³»ç»Ÿ =====
PLUGIN_ENABLED=true
PLUGIN_DIR=./plugins

# ===== æƒé™æ§åˆ¶ =====
RBAC_ENABLED=true

# ===== å®¡è®¡æ—¥å¿— =====
AUDIT_ENABLED=true

# ===== AIåŠŸèƒ½ï¼ˆå¯é€‰ï¼‰=====
# AI_ENABLED=true
# OPENAI_API_KEY=sk-your-api-key

# ===== åˆ†å¸ƒå¼æ‰§è¡Œï¼ˆå¯é€‰ï¼‰=====
# DISTRIBUTED_ENABLED=true
# REDIS_URL=redis://localhost:6379
```

### 4. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç”ŸæˆPrisma Client
npm run prisma:generate

# æ‰§è¡Œæ•°æ®åº“è¿ç§»
npm run prisma:migrate

# ï¼ˆå¯é€‰ï¼‰å¯¼å…¥ç§å­æ•°æ®
npm run prisma:seed
```

---

## ğŸš€ å¯åŠ¨åº”ç”¨

### å¼€å‘æ¨¡å¼

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev:v2

# æˆ–ä½¿ç”¨V1ç‰ˆæœ¬
npm run dev
```

### ç”Ÿäº§æ¨¡å¼

```bash
# 1. æ„å»ºåº”ç”¨
npm run build

# 2. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm run start:v2
```

### ä½¿ç”¨PM2ï¼ˆæ¨èç”¨äºç”Ÿäº§ï¼‰

```bash
# å®‰è£…PM2
npm install -g pm2

# å¯åŠ¨åº”ç”¨
pm2 start npm --name "audit-backend" -- run start:v2

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs audit-backend

# åœæ­¢åº”ç”¨
pm2 stop audit-backend

# é‡å¯åº”ç”¨
pm2 restart audit-backend
```

### éªŒè¯å¯åŠ¨

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:3000/api/system/health

# åº”è¿”å›:
# {"status":"healthy","timestamp":"...","uptime":...}
```

---

## ğŸ¯ é¦–æ¬¡ä½¿ç”¨

### 1. è®¿é—®API

**Base URL**: `http://localhost:3000`

**å¥åº·æ£€æŸ¥**:
```bash
GET http://localhost:3000/api/system/health
```

### 2. åˆ›å»ºç®¡ç†å‘˜è´¦å·

```bash
# ä½¿ç”¨Prisma Studioï¼ˆå›¾å½¢ç•Œé¢ï¼‰
npm run prisma:studio

# åœ¨æµè§ˆå™¨æ‰“å¼€: http://localhost:5555
# åˆ›å»ºUserè®°å½•
```

æˆ–ä½¿ç”¨API:

```bash
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@example.com",
    "password": "Admin123!",
    "name": "ç³»ç»Ÿç®¡ç†å‘˜"
  }'
```

### 3. ç™»å½•è·å–Token

```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@example.com",
    "password": "Admin123!"
  }'

# å“åº”ï¼š
# {
#   "success": true,
#   "data": {
#     "token": "eyJhbGc...",
#     "user": { ... }
#   }
# }
```

### 4. ä½¿ç”¨Tokenè®¿é—®API

```bash
# ä¿å­˜token
TOKEN="eyJhbGc..."

# è·å–ç³»ç»ŸçŠ¶æ€
curl http://localhost:3000/api/system/status \
  -H "Authorization: Bearer $TOKEN"
```

### 5. åˆ›å»ºç¬¬ä¸€ä¸ªå·¥ä½œæµ

```bash
curl -X POST http://localhost:3000/api/workflows \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "æˆ‘çš„ç¬¬ä¸€ä¸ªå·¥ä½œæµ",
    "description": "æµ‹è¯•å·¥ä½œæµ",
    "nodes": [
      {
        "id": "node1",
        "type": "data.input",
        "label": "æ•°æ®è¾“å…¥",
        "position": {"x": 0, "y": 0}
      }
    ],
    "edges": []
  }'
```

---

## ğŸ”§ å¼€å‘å·¥å…·

### æ¨èçš„IDE

- **VS Code** (æ¨è)
  - å®‰è£…æ‰©å±•: Prisma, TypeScript, ESLint

- **WebStorm**
  - å†…ç½®TypeScriptæ”¯æŒ

### æ¨èçš„APIæµ‹è¯•å·¥å…·

- **Postman** - å›¾å½¢ç•Œé¢ï¼Œæ˜“ç”¨
- **Insomnia** - è½»é‡çº§
- **curl** - å‘½ä»¤è¡Œï¼Œå¿«é€Ÿæµ‹è¯•

### æ•°æ®åº“ç®¡ç†å·¥å…·

- **Prisma Studio** - å†…ç½®ï¼Œæ¨è
  ```bash
  npm run prisma:studio
  ```

- **DBeaver** - é€šç”¨æ•°æ®åº“å·¥å…·
- **pgAdmin** - PostgreSQLä¸“ç”¨

---

## ğŸ“š ä¸‹ä¸€æ­¥å­¦ä¹ 

### æ¨èé˜…è¯»é¡ºåº

1. âœ… **å¿«é€Ÿå¯åŠ¨æŒ‡å—** (æœ¬æ–‡æ¡£)
2. ğŸ“– [ç³»ç»Ÿé›†æˆä½¿ç”¨æŒ‡å—](./ç³»ç»Ÿé›†æˆä½¿ç”¨æŒ‡å—.md)
3. ğŸ”Œ [APIæ–‡æ¡£_ç³»ç»Ÿé›†æˆ](./APIæ–‡æ¡£_ç³»ç»Ÿé›†æˆ.md)
4. ğŸš€ [ç”Ÿäº§éƒ¨ç½²æ£€æŸ¥æ¸…å•](./ç”Ÿäº§éƒ¨ç½²æ£€æŸ¥æ¸…å•.md)
5. ğŸ“˜ [é•¿æœŸæ„¿æ™¯åŠŸèƒ½å®ç°æŒ‡å—](./é•¿æœŸæ„¿æ™¯åŠŸèƒ½å®ç°æŒ‡å—.md)

### è¿›é˜¶ä¸»é¢˜

- **æ’ä»¶å¼€å‘**: å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰èŠ‚ç‚¹
- **å·¥ä½œæµè®¾è®¡**: æœ€ä½³å®è·µå’Œæ¨¡å¼
- **æ€§èƒ½ä¼˜åŒ–**: æå‡ç³»ç»Ÿæ€§èƒ½
- **å®‰å…¨åŠ å›º**: ç”Ÿäº§ç¯å¢ƒå®‰å…¨é…ç½®

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¯åŠ¨æ—¶æç¤ºç«¯å£è¢«å ç”¨

**é”™è¯¯**: `Error: listen EADDRINUSE: address already in use :::3000`

**è§£å†³**:
```bash
# Windows
netstat -ano | findstr :3000
taskkill /PID <PID> /F

# Linux/Mac
lsof -ti:3000 | xargs kill -9

# æˆ–ä¿®æ”¹ç«¯å£
# åœ¨ .env æ–‡ä»¶ä¸­: PORT=3001
```

### Q2: æ•°æ®åº“è¿æ¥å¤±è´¥

**é”™è¯¯**: `P1001: Can't reach database server`

**è§£å†³**:
1. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦è¿è¡Œ
   ```bash
   # PostgreSQL
   sudo systemctl status postgresql
   ```

2. æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²
   ```env
   DATABASE_URL="postgresql://user:pass@localhost:5432/dbname"
   ```

3. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™

### Q3: npm install å¤±è´¥

**é”™è¯¯**: `ERESOLVE unable to resolve dependency tree`

**è§£å†³**:
```bash
# æ¸…é™¤ç¼“å­˜
npm cache clean --force

# åˆ é™¤node_moduleså’Œlockæ–‡ä»¶
rm -rf node_modules package-lock.json

# é‡æ–°å®‰è£…
npm install

# æˆ–ä½¿ç”¨ --legacy-peer-deps
npm install --legacy-peer-deps
```

### Q4: Prismaè¿ç§»å¤±è´¥

**é”™è¯¯**: `Migration failed`

**è§£å†³**:
```bash
# é‡ç½®æ•°æ®åº“ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
npm run prisma:migrate reset

# é‡æ–°ç”ŸæˆClient
npm run prisma:generate

# åº”ç”¨è¿ç§»
npm run prisma:migrate
```

### Q5: TypeScriptç¼–è¯‘é”™è¯¯

**é”™è¯¯**: `TS2307: Cannot find module...`

**è§£å†³**:
```bash
# é‡æ–°å®‰è£…ä¾èµ–
npm install

# æ¸…é™¤TypeScriptç¼“å­˜
rm -rf dist/

# é‡æ–°æ„å»º
npm run build
```

### Q6: å†…å­˜ä¸è¶³

**é”™è¯¯**: `JavaScript heap out of memory`

**è§£å†³**:
```bash
# ä¸´æ—¶å¢åŠ å†…å­˜
NODE_OPTIONS=--max-old-space-size=4096 npm run build

# æˆ–åœ¨ package.json ä¸­ä¿®æ”¹scripts
"build": "NODE_OPTIONS=--max-old-space-size=4096 tsc"
```

### Q7: CORSé”™è¯¯

**é”™è¯¯**: `Access to ... has been blocked by CORS policy`

**è§£å†³**:
åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®:
```env
# å¼€å‘ç¯å¢ƒ
CORS_ORIGIN=http://localhost:5173

# ç”Ÿäº§ç¯å¢ƒï¼ˆå¤šä¸ªåŸŸåç”¨é€—å·åˆ†éš”ï¼‰
CORS_ORIGIN=https://yourdomain.com,https://www.yourdomain.com
```

### Q8: JWTéªŒè¯å¤±è´¥

**é”™è¯¯**: `Invalid token`

**è§£å†³**:
1. æ£€æŸ¥tokenæ˜¯å¦æ­£ç¡®å¤åˆ¶ï¼ˆæ— ç©ºæ ¼ï¼‰
2. æ£€æŸ¥tokenæ˜¯å¦è¿‡æœŸ
3. ç¡®è®¤ `JWT_SECRET` ä¸ç”Ÿæˆæ—¶ä¸€è‡´
4. é‡æ–°ç™»å½•è·å–æ–°token

---

## ğŸ†˜ è·å–å¸®åŠ©

### æ–‡æ¡£èµ„æº

- ğŸ“– [å®Œæ•´æ–‡æ¡£ç´¢å¼•](./README.md)
- ğŸ”Œ [APIæ–‡æ¡£](./APIæ–‡æ¡£_ç³»ç»Ÿé›†æˆ.md)
- ğŸ“ [æ•…éšœæ’æŸ¥æ‰‹å†Œ](./æ•…éšœæ’æŸ¥æ‰‹å†Œ.md)

### ç¤¾åŒºæ”¯æŒ

- ğŸ’¬ GitHub Issues: https://github.com/zy6666688/SHENJI/issues
- ğŸ“§ é‚®ä»¶æ”¯æŒ: support@example.com
- ğŸ’¼ ä¼ä¸šæ”¯æŒ: enterprise@example.com

### å¿«é€Ÿè¯Šæ–­

```bash
# è¿è¡Œè¯Šæ–­è„šæœ¬
npm run test:integration

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
npm run dev:v2 --verbose

# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
curl http://localhost:3000/api/system/status
```

---

## âœ… æˆåŠŸå¯åŠ¨æ£€æŸ¥è¡¨

å®Œæˆä»¥ä¸‹æ£€æŸ¥ç¡®è®¤ç³»ç»Ÿæ­£å¸¸è¿è¡Œï¼š

- [ ] Node.jsç‰ˆæœ¬ >= 18.x
- [ ] ä¾èµ–å®‰è£…æˆåŠŸ
- [ ] é…ç½®æ–‡ä»¶å·²åˆ›å»º
- [ ] æ•°æ®åº“åˆå§‹åŒ–å®Œæˆ
- [ ] åº”ç”¨æˆåŠŸå¯åŠ¨
- [ ] å¥åº·æ£€æŸ¥è¿”å› `healthy`
- [ ] èƒ½å¤ŸæˆåŠŸç™»å½•
- [ ] APIè°ƒç”¨æ­£å¸¸

---

## ğŸ‰ æ­å–œï¼

æ‚¨å·²æˆåŠŸå¯åŠ¨ **å®¡è®¡æ•°æ™ºæ V2.0**ï¼

### ä¸‹ä¸€æ­¥

1. ğŸ” **æ¢ç´¢åŠŸèƒ½**: å°è¯•åˆ›å»ºå·¥ä½œæµ
2. ğŸ“– **æ·±å…¥å­¦ä¹ **: é˜…è¯»è¯¦ç»†æ–‡æ¡£
3. ğŸ”Œ **å¼€å‘æ’ä»¶**: æ‰©å±•ç³»ç»ŸåŠŸèƒ½
4. ğŸš€ **ç”Ÿäº§éƒ¨ç½²**: æŒ‰ç…§éƒ¨ç½²æ¸…å•æ“ä½œ

### æœ‰é—®é¢˜ï¼Ÿ

å‚è€ƒ[æ•…éšœæ’æŸ¥æ‰‹å†Œ](./æ•…éšœæ’æŸ¥æ‰‹å†Œ.md)æˆ–[è”ç³»æˆ‘ä»¬](#è·å–å¸®åŠ©)

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025å¹´1æœˆ4æ—¥  
**é€‚ç”¨ç‰ˆæœ¬**: V2.0.0  
**ç»´æŠ¤å›¢é˜Ÿ**: SHENJI Team

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸŠ
